<template>
        <div class="container">
       <svg 
        id="drawSvg" 
        class="box"
        ref="box"   
        @click="onClick"
        width="500" 
        height="500" 
        version="1.1" 
        viewBox="0 0 136.13 144.41" 
        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <defs>
            <linearGradient id="linearGradient1012">
            <stop stop-color="#4d4d4d" offset="0"/>
            <stop stop-color="#c8b7b7" offset="1"/>
            </linearGradient>
            <linearGradient id="linearGradient1014" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="translate(-53.373 -21.489)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-2" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="translate(-37.113 -21.29)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-2-7" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(2.0438 0 0 1.1414 -289.74 -83.883)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-2-7-5" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(1.2918 0 0 1.495 -166.84 -170.25)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-2-7-4" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(2.0438 0 0 3.0001 -289.64 -390.27)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-9" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(1 0 0 1.9899 -130.85 -185.6)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-9-7" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(1 0 0 1.9899 -108.17 -185.6)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            <linearGradient id="linearGradient1014-9-1" x1="108.37" x2="169.45" y1="273.66" y2="157.96" gradientTransform="matrix(.15821 0 0 1.9899 91.831 -219.61)" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient1012"/>
            </defs>
            <g transform="translate(-12.993 -63.934)">
            <g transform="translate(0 -.25422)" fill="#c8b7b7" fill-rule="evenodd">
            <ellipse cx="43.987" cy="89.769" rx="11.15" ry="14.552"/>
            <rect x="25.523" y="133.36" width="14.552" height="75.241" ry="10.378"/>
            <rect x="25.513" y="108.48" width="37.042" height="52.187" ry="7.5451"/>
            <g transform="translate(-6.6618 6.0624)">
                <rect x="19.655" y="97.518" width="10.336" height="43.166" ry="5.1678"/>
                <rect x="19.655" y="97.518" width="61.988" height="13.985" ry="6.4256"/>
                <rect x="71.307" y="97.518" width="10.336" height="43.166" ry="5.1678"/>
            </g>
            <rect x="48.007" y="133.36" width="14.552" height="75.241" ry="10.378"/>
            </g>
            <ellipse cx="32.317" cy="160.64" rx="8.419" ry="18.615" fill="url(#linearGradient1014-9)" fill-rule="evenodd"/>
            <g fill="#c8b7b7" fill-rule="evenodd">
            <ellipse cx="118.13" cy="89.515" rx="11.15" ry="14.552"/>
            <rect x="99.669" y="133.1" width="14.552" height="75.241" ry="10.378"/>
            <rect x="99.66" y="108.22" width="37.042" height="52.187" ry="7.5451"/>
            <g transform="translate(67.484 5.8082)">
                <rect x="19.655" y="97.518" width="10.336" height="43.166" ry="5.1678"/>
                <rect x="19.655" y="97.518" width="61.988" height="13.985" ry="6.4256"/>
                <rect x="71.307" y="97.518" width="10.336" height="43.166" ry="5.1678"/>
            </g>
            <rect x="122.15" y="133.1" width="14.552" height="75.241" ry="10.378"/>
            </g>
            <g fill-rule="evenodd">
            <ellipse cx="109.8" cy="152.5" rx="8.419" ry="9.3544" fill="url(#linearGradient1014)"/>
            <ellipse cx="126.06" cy="152.7" rx="8.419" ry="9.3544" fill="url(#linearGradient1014-2)"/>
            <ellipse cx="43.94" cy="89.864" rx="10.876" ry="13.985" fill="url(#linearGradient1014-2-7-5)"/>
            <ellipse cx="54.996" cy="160.64" rx="8.419" ry="18.615" fill="url(#linearGradient1014-9-7)"/>
            <ellipse cx="43.845" cy="131.72" rx="17.207" ry="28.064" fill="url(#linearGradient1014-2-7-4)"/>
            <ellipse cx="43.751" cy="114.72" rx="17.207" ry="10.677" fill="url(#linearGradient1014-2-7)"/>
            <ellipse cx="117.65" cy="126.62" rx="1.3319" ry="18.615" fill="url(#linearGradient1014-9-1)"/>
            </g>
            <text x="33.072918" y="67.46875" font-family="Inter" font-size="4.7942px" stroke-width=".26458" style="font-variation-settings:'wght' 700;line-height:1.25" xml:space="preserve"><tspan x="33.072918" y="67.46875" stroke-width=".26458">FRONT</tspan></text>
            <text x="110.74702" y="67.46875" font-family="Inter" font-size="4.7942px" stroke-width=".26458" style="font-variation-settings:'wght' 700;line-height:1.25" xml:space="preserve"><tspan x="110.74702" y="67.46875" stroke-width=".26458">BACK</tspan></text>
            </g>

            <g v-for="(point, index) in points" 
                :key="index+'string'">
            <circle  
                :cx="point.x" :cy="point.y" 
                r="3" 
                stroke="#AD2828"  
                stroke-width="3" 
                fill="#AD2828"  />
            <text  :x="point.x-1.3" :y="point.y+1.8" stroke="none" fill="#fff" font-size="5" >{{index}}</text>
            </g>
            </svg>
        <div class="point-desc-list">
            <div class="afection" v-for="(point, index) in points" 
                :key="index+'string'">
                {{index}}: {{point.desc?point.desc:"No description"}}
            </div>
        </div>

      <v-dialog
      v-model="dialog"
      persistent
      max-width="600px"
    >

      <v-card>
        <v-card-title>
          <span class="headline">Injury Description</span>
        </v-card-title>

        <v-card-text>
          <v-container>
            <v-row>              
              <v-col cols="12">
                <v-text-field
                  ref = "field_description"
                  label="Enter description"
                  autofocus=true
                  required
                  v-model="tempDescription"
                  @keyup.enter="saveDescription"
                ></v-text-field>
              </v-col>              
            </v-row>
          </v-container>
        </v-card-text>
        <v-card-actions>
          <v-spacer></v-spacer>
          <v-btn
            color="blue darken-1"
            text
            @click="closeDialog"
          >
            Close
          </v-btn>
          <v-btn
            color="blue darken-1"
            text
            @click="saveDescription"
          >
            Save
          </v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>
    </div>

        
</template>

<script>

export default {
    name: "human-plan",
    data() {
        return{
            board: '',
            circle: false,
            viewbox: null,
            dialog: false,
            tempPoint:{},
            tempDescription : "",
            square: {
                x: 35,
                y: 35,
            },
            points: [ ],
            dragOffsetX: null,
            dragOffsetY: null,
            svg:null,
            pt:null
        }
    },
    computed:{
        canvasWidth: function(){
            return this.board.clientWidth
        },

        canvasHeight: function(){
            return this.board.clientHeight
        },
        circleExist(){
            return this.circle;
        },
        viewboxText(){
            return `0 0 ${this.board.clientWidth} ${this.board.clientHeight}` 
        },
    },
    methods:{
        showDialog(){
          this.dialog=true;
        },
        closeDialog(){
          this.dialog=false;
          this.tempDescription="";
        },
        initBoard(){
            this.svg = document.getElementById("drawSvg");
            this.pt = this.svg.createSVGPoint();
            this.board = document.getElementById("drawSvg")
            this.viewbox = document.getElementById("drawSvg").viewBox.baseVal;
            console.log(this.viewbox)

        },
        onClick(e){            
            this.pt.x = e.clientX;
            this.pt.y = e.clientY;

            var cursorpt =  this.pt.matrixTransform(this.svg.getScreenCTM().inverse());
            this.tempPoint= {"x": cursorpt.x ,"y": cursorpt.y};

            this.showDialog();
        },
        saveDescription(e){
            e.preventDefault()
            this.points.push({...this.tempPoint, "desc":this.tempDescription});
            this.closeDialog();
        }
    
    },
    created(){
        
    },
    mounted(){
        this.initBoard();
    }
        
    
}
</script>

<style lang="scss" scoped>
    .container{
        margin-top: 20px;
    }

    .box{
        margin: auto;
        position: center;
        display: block; 
    }

    .point-desc-list{
        margin: auto;
        width: 40%;
        background:rgb(236, 235, 235);
        margin-top: 30px;
    }

    .afection {
        text-align: left;
        padding: 5px;
        border: 1px solid rgb(156, 152, 152);
        border-radius: 5px;
        
    }

</style>



